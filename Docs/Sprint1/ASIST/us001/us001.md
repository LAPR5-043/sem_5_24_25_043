# US001 Como administrador do sistema quero alterar a informa√ß√£o apresentada no terminal do sistema Linux antes de me autenticar, alterando a informa√ß√£o por omiss√£o por uma mais criativa que contenha obrigatoriamente a data e o n√∫mero de utilizadores ativos. 

## Passos a seguir


### 1) Editar a mensagem a apresentar 
    Como queremos manipular informa√ß√£o din√¢mica, (data e n¬∫ de utilizadores ativos), necessitamos de um script que ir√° correr em cada conex√£o via ssh.
    Desta forma iremos utilizar o seguinte script, conseguindo extratir do sistema as informa√ß√µes referentes √† data e n¬∫ de utilizadores ativos, sendo que estes s√£o distiguidos por terem a /bin/bash shell.
    Devemos tamb√©m colocar este script no seguinte caminho
#### /etc/ssh/display_info.sh

    #!/bin/bash

    # Certificar que limpamos o ficheiro
    > /etc/ssh/banner.txt
    > /etc/issue

    # Obter a data atual
    DATE=$(date "+%Y-%m-%d %H:%M:%S")

    # Obter o n√∫mero de users ativos (example: users with /bin/bash shell)
    ACTIVATED_USERS=$(who | wc -l)

    # Criar a mensagem do banner
    MESSAGE=$(cat <<EOF
    ==============================================
    Hello mate, It seems that you are new here
    If you want to explore the system, you will
        need to login first. Enjoy your stay!

        Remember, you are not alone here!
        Respect the others and have fun!
    ==============================================

    üìÖ Date and Time:     $CURRENT_DATE


    How many nerds you can meet right now:

    üë• Logged In Users:   $ACTIVATED_USERS

    ==============================================
    EOF
    )

    # Certificar que temos permisss√µes para escrever 
    chmod 644 /etc/ssh/banner.txt
    chmod 644 /etc/issue

    {
    echo -e "$MESSAGE" | /usr/games/cowsay -W 46 -n -f tux
    } > /etc/ssh/banner.txt 


    {
    echo -e "$MESSAGE" | /usr/games/cowsay -W 46 -n -f tux
    } > /etc/issue


### 2.1) Ativar a apresenta√ß√£o do banner no ssh
    Como podemos ver pelo script anteriormente apresentado, para apresentar a mensagem produzida pelo script, iremos redirecionar o stdout para o ficheiro /etc/ssh/banner.txt, pois ir√° ser a partir da utiliza√ß√£o de banner que iremos apresentar as informa√ß√µes pedidas. Para ativarmos o banner, temos de ir ao ficheiro /etc/ssh/sshd_config e alterar a op√ß√£o do banner para a seguinte:
####
    Banner /etc/ssh/banner.txt

### 2.2) Redirecionar tamb√©m o output do script para o /etc/issue
    De forma a quem est√° a aceder √† maquina localmente tamb√©m ter acesso a estas informa√ß√µes, redirecionamos o output do script tamb√©m para o ficheiro /etc/issue, que vai fazer com que esta informa√ß√£o seja passada tamb√©m para o utilizador local.



### 3) Colocar o script em execu√ß√£o autom√°tica 
    Para termos sempre a informa√ß√£o atualizada, temos de fazer com que o script esteja constantemente a ser executado, para tal, utilizamos o 
    Crontab. O Crontab √© um servi√ßo que nos ajuda a agendar a execu√ß√£o de determinada a√ß√£o, explicitando a rotina de execu√ß√£o na sua tabela, da seguinte forma:
####
    root@debian:/# crontab -e

    De seguida iremos adicionar a linha a indicar a execu√ß√£o constante, ao segundo, do scrip, adicionando a seguinte linha e salvando de seguida:

    * * * * * /etc/ssh/banner.txt

### 4) Dar permiss√µes ao ficheiro do script
    Para o ficheiro conseguir executar √© necess√°rio ter permiss√µes, dadas com o seguinte comando
####
    root@debian:/# chmod +x /etc/ssh/display_info.sh

### 5) Reiniciar o servi√ßo de SSH 
    De forma a consumir as altera√ß√µes feitas, devemos reiniciar o SSH com o seguitne comando:
####
    root@debian:/# sudo systemctl restart sshd
